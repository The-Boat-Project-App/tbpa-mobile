{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = useImageSpecifiedDimensions;\nvar _react = require(\"react\");\nvar _getDimensionsWithAspectRatio = _interopRequireDefault(require(\"./getDimensionsWithAspectRatio\"));\nvar _reactNative = require(\"react-native-web/dist/index\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction normalizeSize(dimension, options) {\n  var containerDimension = options.containerDimension || null;\n  var enablePercentWidth = options.enablePercentWidth || false;\n  if (dimension === null || dimension === undefined || Number.isNaN(dimension)) {\n    return null;\n  }\n  if (typeof dimension === 'number') {\n    return dimension;\n  }\n  if (dimension.search('%') !== -1 && enablePercentWidth && typeof containerDimension === 'number') {\n    return parseFloat(dimension) * containerDimension / 100;\n  } else if (dimension.trim().match(/^[\\d.]+$/)) {\n    return parseFloat(dimension);\n  }\n  return null;\n}\n\nfunction deriveSpecifiedDimensionsFromProps(_ref) {\n  var width = _ref.width,\n    height = _ref.height,\n    contentWidth = _ref.contentWidth,\n    flatStyle = _ref.flatStyle,\n    enablePercentWidth = _ref.enableExperimentalPercentWidth;\n  var normalizeOptionsWidth = {\n    enablePercentWidth: enablePercentWidth,\n    containerDimension: contentWidth\n  };\n  var normalizeOptionsHeight = {\n    enablePercentWidth: false\n  };\n  var widthProp = normalizeSize(width, normalizeOptionsWidth);\n  var heightProp = normalizeSize(height, normalizeOptionsHeight);\n  var styleWidth = normalizeSize(flatStyle.width, normalizeOptionsWidth);\n  var styleHeight = normalizeSize(flatStyle.height, normalizeOptionsHeight);\n  return (0, _getDimensionsWithAspectRatio.default)(styleWidth !== null && styleWidth !== void 0 ? styleWidth : widthProp, styleHeight !== null && styleHeight !== void 0 ? styleHeight : heightProp, flatStyle.aspectRatio);\n}\nfunction useImageSpecifiedDimensions(props) {\n  var contentWidth = props.contentWidth,\n    enableExperimentalPercentWidth = props.enableExperimentalPercentWidth,\n    style = props.style,\n    width = props.width,\n    height = props.height;\n  var flatStyle = (0, _react.useMemo)(function () {\n    return _reactNative.StyleSheet.flatten(style) || {};\n  }, [style]);\n  var specifiedDimensions = (0, _react.useMemo)(function () {\n    return deriveSpecifiedDimensionsFromProps({\n      contentWidth: contentWidth,\n      enableExperimentalPercentWidth: enableExperimentalPercentWidth,\n      width: width,\n      height: height,\n      flatStyle: flatStyle\n    });\n  }, [contentWidth, enableExperimentalPercentWidth, flatStyle, height, width]);\n  return {\n    flatStyle: flatStyle,\n    specifiedDimensions: specifiedDimensions\n  };\n}","map":{"version":3,"mappings":";;;;;;AAAA;AAKA;AAAA;;;;;;AAGA,SAASA,aAAT,CACEC,SADF,EAEEC,OAFF,EAME;EACA,IAAMC,kBAAkB,GAAGD,OAAO,CAACC,kBAAR,IAA8B,IAAzD;EACA,IAAMC,kBAAkB,GAAGF,OAAO,CAACE,kBAAR,IAA8B,KAAzD;EACA,IACEH,SAAS,KAAK,IAAd,IACAA,SAAS,KAAKI,SADd,IAEAC,MAAM,CAACC,KAAP,CAAaN,SAAb,CAHF,EAIE;IACA,OAAO,IAAP;EACD;EACD,IAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;IACjC,OAAOA,SAAP;EACD;EACD,IACEA,SAAS,CAACO,MAAV,CAAiB,GAAjB,MAA0B,CAAC,CAA3B,IACAJ,kBADA,IAEA,OAAOD,kBAAP,KAA8B,QAHhC,EAIE;IACA,OAAQM,UAAU,CAACR,SAAD,CAAV,GAAwBE,kBAAzB,GAA+C,GAAtD;EACD,CAND,MAMO,IAAIF,SAAS,CAACS,IAAV,GAAiBC,KAAjB,CAAuB,UAAvB,CAAJ,EAAwC;IAC7C,OAAOF,UAAU,CAACR,SAAD,CAAjB;EACD;EACD,OAAO,IAAP;AACD;;AAKD,SAASW,kCAAT,OASmE;EAAA,IARjEC,KAD0C,QAC1CA,KAD0C;IAE1CC,MAF0C,QAE1CA,MAF0C;IAG1CC,YAH0C,QAG1CA,YAH0C;IAI1CC,SAJ0C,QAI1CA,SAJ0C;IAKVZ,0BAAhCa,8BAA8B;EAK9B,IAAMC,qBAAqB,GAAG;IAC5Bd,kBAD4B,EAC5BA,kBAD4B;IAE5BD,kBAAkB,EAAEY;EAFQ,CAA9B;EAIA,IAAMI,sBAAsB,GAAG;IAC7Bf,kBAAkB,EAAE;EADS,CAA/B;EAGA,IAAMgB,SAAS,GAAGpB,aAAa,CAACa,KAAD,EAAQK,qBAAR,CAA/B;EACA,IAAMG,UAAU,GAAGrB,aAAa,CAACc,MAAD,EAASK,sBAAT,CAAhC;EACA,IAAMG,UAAU,GAAGtB,aAAa,CAACgB,SAAS,CAACH,KAAX,EAAkBK,qBAAlB,CAAhC;EACA,IAAMK,WAAW,GAAGvB,aAAa,CAACgB,SAAS,CAACF,MAAX,EAAmBK,sBAAnB,CAAjC;EACA,OAAO,2CACLG,UADK,aACLA,UADK,cACLA,UADK,GACSF,SADT,EAELG,WAFK,aAELA,WAFK,cAELA,WAFK,GAEUF,UAFV,EAGLL,SAAS,CAACQ,WAHL,CAAP;AAKD;AAEc,SAASC,2BAAT,CACbC,KADa,EAEb;EACA,IAAQX,YAAF,GACJW,KADF,CAAQX,YAAF;IAAgBE,8BAAhB,GACJS,KADF,CAAsBT,8BAAhB;IAAgDU,KAAhD,GACJD,KADF,CAAsDC,KAAhD;IAAuDd,KAAvD,GACJa,KADF,CAA6Db,KAAvD;IAA8DC,SAClEY,KADF,CAAoEZ;EAEpE,IAAME,SAAS,GAAG,oBAAQ;IAAA,OAAMY,wBAAWC,OAAX,CAAmBF,KAAnB,KAA6B,EAA3C;EAAA,GAA+C,CAACA,KAAD,CAA/C,CAAlB;EACA,IAAMG,mBAAmB,GAAG,oBAC1B;IAAA,OACElB,kCAAkC,CAAC;MACjCG,YADiC,EACjCA,YADiC;MAEjCE,8BAFiC,EAEjCA,8BAFiC;MAGjCJ,KAHiC,EAGjCA,KAHiC;MAIjCC,MAJiC,EAIjCA,MAJiC;MAKjCE;IALiC,CAAD,CAFV;EAAA,GAS1B,CAACD,YAAD,EAAeE,8BAAf,EAA+CD,SAA/C,EAA0DF,MAA1D,EAAkED,KAAlE,CAT0B,CAA5B;EAWA,OAAO;IAAEG,SAAF,EAAEA,SAAF;IAAac;EAAb,CAAP;AACD","names":["normalizeSize","dimension","options","containerDimension","enablePercentWidth","undefined","Number","isNaN","search","parseFloat","trim","match","deriveSpecifiedDimensionsFromProps","width","height","contentWidth","flatStyle","enableExperimentalPercentWidth","normalizeOptionsWidth","normalizeOptionsHeight","widthProp","heightProp","styleWidth","styleHeight","aspectRatio","useImageSpecifiedDimensions","props","style","StyleSheet","flatten","specifiedDimensions"],"sources":["useImageSpecifiedDimensions.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport {\n  UseIMGElementStateProps,\n  IncompleteImageDimensions\n} from './img-types';\nimport getDimensionsWithAspectRatio from './getDimensionsWithAspectRatio';\nimport { StyleSheet } from 'react-native';\n\nfunction normalizeSize(\n  dimension: string | number | null | undefined,\n  options: Partial<{\n    containerDimension: number | null;\n    enablePercentWidth: boolean;\n  }>\n) {\n  const containerDimension = options.containerDimension || null;\n  const enablePercentWidth = options.enablePercentWidth || false;\n  if (\n    dimension === null ||\n    dimension === undefined ||\n    Number.isNaN(dimension)\n  ) {\n    return null;\n  }\n  if (typeof dimension === 'number') {\n    return dimension;\n  }\n  if (\n    dimension.search('%') !== -1 &&\n    enablePercentWidth &&\n    typeof containerDimension === 'number'\n  ) {\n    return (parseFloat(dimension) * containerDimension) / 100;\n  } else if (dimension.trim().match(/^[\\d.]+$/)) {\n    return parseFloat(dimension);\n  }\n  return null;\n}\n\n/**\n * Extract specified dimensions from props.\n */\nfunction deriveSpecifiedDimensionsFromProps({\n  width,\n  height,\n  contentWidth,\n  flatStyle,\n  enableExperimentalPercentWidth: enablePercentWidth\n}: Pick<\n  UseIMGElementStateProps,\n  'width' | 'height' | 'contentWidth' | 'enableExperimentalPercentWidth'\n> & { flatStyle: Record<string, any> }): IncompleteImageDimensions {\n  const normalizeOptionsWidth = {\n    enablePercentWidth,\n    containerDimension: contentWidth\n  };\n  const normalizeOptionsHeight = {\n    enablePercentWidth: false\n  };\n  const widthProp = normalizeSize(width, normalizeOptionsWidth);\n  const heightProp = normalizeSize(height, normalizeOptionsHeight);\n  const styleWidth = normalizeSize(flatStyle.width, normalizeOptionsWidth);\n  const styleHeight = normalizeSize(flatStyle.height, normalizeOptionsHeight);\n  return getDimensionsWithAspectRatio(\n    styleWidth ?? widthProp,\n    styleHeight ?? heightProp,\n    flatStyle.aspectRatio\n  );\n}\n\nexport default function useImageSpecifiedDimensions(\n  props: UseIMGElementStateProps\n) {\n  const { contentWidth, enableExperimentalPercentWidth, style, width, height } =\n    props;\n  const flatStyle = useMemo(() => StyleSheet.flatten(style) || {}, [style]);\n  const specifiedDimensions = useMemo(\n    () =>\n      deriveSpecifiedDimensionsFromProps({\n        contentWidth,\n        enableExperimentalPercentWidth,\n        width,\n        height,\n        flatStyle\n      }),\n    [contentWidth, enableExperimentalPercentWidth, flatStyle, height, width]\n  );\n  return { flatStyle, specifiedDimensions };\n}\n"]},"metadata":{},"sourceType":"script"}