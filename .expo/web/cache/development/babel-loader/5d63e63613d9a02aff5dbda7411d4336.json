{"ast":null,"code":"\"use strict\";\n\nvar _defineProperty = require(\"@babel/runtime/helpers/defineProperty\");\nvar _objectWithoutProperties = require(\"@babel/runtime/helpers/objectWithoutProperties\");\nvar _excluded = [\"source\"],\n  _excluded2 = [\"onDocumentMetadataLoaded\", \"onTTreeChange\", \"contentWidth\"],\n  _excluded3 = [\"source\"],\n  _excluded4 = [\"source\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.renderSourcePropTypes = void 0;\nvar _equals = _interopRequireDefault(require(\"ramda/src/equals\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactNative = require(\"react-native-web/dist/index\");\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\nvar _ttreeEventsContext = _interopRequireDefault(require(\"./context/ttreeEventsContext\"));\nvar _isUriSource = _interopRequireDefault(require(\"./helpers/isUriSource\"));\nvar _SourceLoaderUri = _interopRequireDefault(require(\"./SourceLoaderUri\"));\nvar _SourceLoaderInline = _interopRequireDefault(require(\"./SourceLoaderInline\"));\nvar _SourceLoaderDom = _interopRequireDefault(require(\"./SourceLoaderDom\"));\nvar _debugMessages = _interopRequireDefault(require(\"./debugMessages\"));\nvar _contentWidthContext = _interopRequireDefault(require(\"./context/contentWidthContext\"));\nvar _isDomSource = _interopRequireDefault(require(\"./helpers/isDomSource\"));\nvar _useProfiler = _interopRequireDefault(require(\"./hooks/useProfiler\"));\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n  var cache = _getRequireWildcardCache(nodeInterop);\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj.default = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar renderSourcePropTypes = {\n  source: _propTypes.default.oneOfType([_propTypes.default.shape({\n    html: _propTypes.default.string.isRequired,\n    baseUrl: _propTypes.default.string\n  }), _propTypes.default.shape({\n    dom: _propTypes.default.object.isRequired,\n    baseUrl: _propTypes.default.string\n  }), _propTypes.default.shape({\n    uri: _propTypes.default.string.isRequired,\n    method: _propTypes.default.string,\n    body: _propTypes.default.any,\n    headers: _propTypes.default.object\n  })]),\n  onTTreeChange: _propTypes.default.func,\n  onHTMLLoaded: _propTypes.default.func,\n  onDocumentMetadataLoaded: _propTypes.default.func,\n  contentWidth: _propTypes.default.number\n};\nexports.renderSourcePropTypes = renderSourcePropTypes;\nfunction isEmptySource(source) {\n  return !source || typeof source.uri !== 'string' && typeof source.html !== 'string' && !source.dom;\n}\nfunction RawSourceLoader(_ref) {\n  var source = _ref.source,\n    props = _objectWithoutProperties(_ref, _excluded);\n  if (isEmptySource(source)) {\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      console.warn(_debugMessages.default.noSource);\n    }\n    return null;\n  }\n  if ((0, _isUriSource.default)(source)) {\n    return _react.default.createElement(_SourceLoaderUri.default, _objectSpread({\n      source: source\n    }, props));\n  }\n  if ((0, _isDomSource.default)(source)) {\n    return _react.default.createElement(_SourceLoaderDom.default, _objectSpread({\n      source: source\n    }, props));\n  }\n  return _react.default.createElement(_SourceLoaderInline.default, _objectSpread({\n    source: source\n  }, props));\n}\n\nfunction shallowEqual(prop1, prop2) {\n  if (!(0, _equals.default)(Object.keys(prop1), Object.keys(prop2))) {\n    return false;\n  }\n  for (var key in prop1) {\n    if (prop1[key] !== prop2[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nvar RenderHTMLSource = (0, _react.memo)(function RenderHtmlSource(_ref2) {\n  var onDocumentMetadataLoaded = _ref2.onDocumentMetadataLoaded,\n    onTTreeChange = _ref2.onTTreeChange,\n    contentWidth = _ref2.contentWidth,\n    props = _objectWithoutProperties(_ref2, _excluded2);\n  var profile = (0, _useProfiler.default)({\n    prop: 'onDocumentMetadataLoaded or onTTreeChange'\n  });\n  var ttreeEvents = (0, _react.useMemo)(function () {\n    typeof __DEV__ === 'boolean' && __DEV__ && profile();\n    return {\n      onDocumentMetadataLoaded: onDocumentMetadataLoaded,\n      onTTreeChange: onTTreeChange\n    };\n  }, [onDocumentMetadataLoaded, onTTreeChange, profile]);\n  if (typeof __DEV__ === 'boolean' && __DEV__) {\n    if (!(typeof contentWidth === 'number')) {\n      console.warn(_debugMessages.default.contentWidth);\n    }\n  }\n  return _react.default.createElement(_ttreeEventsContext.default.Provider, {\n    value: ttreeEvents\n  }, _react.default.createElement(_contentWidthContext.default.Provider, {\n    value: contentWidth || _reactNative.Dimensions.get('window').width\n  }, _react.default.createElement(RawSourceLoader, props)));\n}, function (_ref3, _ref4) {\n  var currSource = _ref4.source,\n    curr = _objectWithoutProperties(_ref4, _excluded3);\n  var prevSource = _ref3.source,\n    prev = _objectWithoutProperties(_ref3, _excluded4);\n  return shallowEqual(prevSource, currSource) && shallowEqual(prev, curr);\n});\n\nRenderHTMLSource.propTypes = renderSourcePropTypes;\nvar _default = RenderHTMLSource;\nexports.default = _default;","map":{"version":3,"mappings":"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","names":["renderSourcePropTypes","source","PropTypes","oneOfType","shape","html","string","isRequired","baseUrl","dom","object","uri","method","body","any","headers","onTTreeChange","func","onHTMLLoaded","onDocumentMetadataLoaded","contentWidth","number","isEmptySource","RawSourceLoader","props","__DEV__","console","warn","debugMessage","noSource","React","createElement","SourceLoaderUri","SourceLoaderDom","SourceLoaderInline","shallowEqual","prop1","prop2","Object","keys","key","RenderHTMLSource","RenderHtmlSource","profile","prop","ttreeEvents","_react","_ttreeEventsContext","Provider","value","_contentWidthContext","Dimensions","get","width","currSource","curr","prevSource","prev","propTypes"],"sources":["RenderHTMLSource.tsx"],"sourcesContent":["import equals from 'ramda/src/equals';\nimport React, { memo, ReactElement, useMemo } from 'react';\nimport { Dimensions } from 'react-native';\nimport PropTypes from 'prop-types';\nimport ttreeEventsContext from './context/ttreeEventsContext';\nimport isUriSource from './helpers/isUriSource';\nimport { SourceLoaderProps, TTreeEvents } from './internal-types';\nimport {\n  HTMLSourceDom,\n  HTMLSourceInline,\n  RenderHTMLSourceProps,\n  HTMLSourceUri,\n  HTMLSource\n} from './shared-types';\nimport SourceLoaderUri from './SourceLoaderUri';\nimport SourceLoaderInline from './SourceLoaderInline';\nimport SourceLoaderDom from './SourceLoaderDom';\nimport debugMessage from './debugMessages';\nimport contentWidthContext from './context/contentWidthContext';\nimport isDomSource from './helpers/isDomSource';\nimport useProfiler from './hooks/useProfiler';\n\nexport type RenderHTMLSourcePropTypes = Record<\n  keyof RenderHTMLSourceProps,\n  any\n>;\n\nexport const renderSourcePropTypes: RenderHTMLSourcePropTypes = {\n  source: PropTypes.oneOfType([\n    PropTypes.shape({\n      html: PropTypes.string.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      dom: PropTypes.object.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      uri: PropTypes.string.isRequired,\n      method: PropTypes.string,\n      body: PropTypes.any,\n      headers: PropTypes.object\n    })\n  ]),\n  onTTreeChange: PropTypes.func,\n  onHTMLLoaded: PropTypes.func,\n  onDocumentMetadataLoaded: PropTypes.func,\n  contentWidth: PropTypes.number\n};\n\nfunction isEmptySource(source: undefined | HTMLSource) {\n  return (\n    !source ||\n    (typeof (source as HTMLSourceUri).uri !== 'string' &&\n      typeof (source as HTMLSourceInline).html !== 'string' &&\n      !(source as HTMLSourceDom).dom)\n  );\n}\n\nfunction RawSourceLoader({\n  source,\n  ...props\n}: SourceLoaderProps): ReactElement | null {\n  if (isEmptySource(source)) {\n    /* istanbul ignore next */\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      console.warn(debugMessage.noSource);\n    }\n    return null;\n  }\n  if (isUriSource(source)) {\n    return React.createElement(SourceLoaderUri, { source, ...props });\n  }\n  if (isDomSource(source)) {\n    return React.createElement(SourceLoaderDom, { source, ...props });\n  }\n  return React.createElement(SourceLoaderInline, { source, ...props });\n}\n\n// check if for each key of two objects, the values are equal\nfunction shallowEqual(prop1: any, prop2: any) {\n  if (!equals(Object.keys(prop1), Object.keys(prop2))) {\n    return false;\n  }\n  for (const key in prop1) {\n    if (prop1[key] !== prop2[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * A React component to render HTML snippets.\n *\n * @remarks This component is useful when you have to load dozens of HTML\n * snippets with the same config. Performance is expected to improve in such\n * scenarios.\n *\n * @warning This component requires to have {@link TRenderEngineProvider}\n * and {@link RenderHTMLConfigProvider} as parents.\n */\nconst RenderHTMLSource = memo(\n  function RenderHtmlSource({\n    onDocumentMetadataLoaded,\n    onTTreeChange,\n    contentWidth,\n    ...props\n  }: RenderHTMLSourceProps) {\n    const profile = useProfiler({\n      prop: 'onDocumentMetadataLoaded or onTTreeChange'\n    });\n    const ttreeEvents: TTreeEvents = useMemo(() => {\n      typeof __DEV__ === 'boolean' && __DEV__ && profile();\n      return {\n        onDocumentMetadataLoaded,\n        onTTreeChange\n      };\n    }, [onDocumentMetadataLoaded, onTTreeChange, profile]);\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      if (!(typeof contentWidth === 'number')) {\n        console.warn(debugMessage.contentWidth);\n      }\n    }\n    return (\n      <ttreeEventsContext.Provider value={ttreeEvents}>\n        <contentWidthContext.Provider\n          value={contentWidth || Dimensions.get('window').width}>\n          {React.createElement(RawSourceLoader, props)}\n        </contentWidthContext.Provider>\n      </ttreeEventsContext.Provider>\n    );\n  },\n  ({ source: prevSource, ...prev }, { source: currSource, ...curr }) => {\n    return shallowEqual(prevSource, currSource) && shallowEqual(prev, curr);\n  }\n);\n\n/**\n * @ignore\n */\n(RenderHTMLSource as any).propTypes = renderSourcePropTypes;\n\nexport default RenderHTMLSource;\n"]},"metadata":{},"sourceType":"script"}